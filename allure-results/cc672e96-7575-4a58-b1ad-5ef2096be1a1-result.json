{"name": "test_kyc", "status": "broken", "statusDetails": {"message": "selenium.common.exceptions.TimeoutException: Message: \nStacktrace:\nNoSuchElementError: An element could not be located on the page using the given search parameters.\n    at AndroidUiautomator2Driver.findElOrEls (C:\\Users\\a.jamshidi\\.appium\\node_modules\\appium-uiautomator2-driver\\node_modules\\appium-android-driver\\lib\\commands\\find.ts:86:11)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at AndroidUiautomator2Driver.findElOrElsWithProcessing (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:60:12)\n    at AndroidUiautomator2Driver.findElement (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:75:12)", "trace": "open_app_without_login = <appium.webdriver.webdriver.WebDriver (session=\"a5d6f685-c244-4549-8038-272446425973\")>\n\n    @pytest.mark.order(1)\n    @allure.feature(\"User Account Creation\")\n    @allure.story(\"Create a new user account\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    def test_kyc(open_app_without_login):\n        driver = open_app_without_login\n        accept_page = AcceptRulesAndRegulations(driver)\n    \n        # بارگذاری فایل JSON برای دریافت متون مرجع\n        text_reference = load_text_reference()\n    \n        # متغیر برای ذخیره نتیجه تست\n        errors = []\n        try:\n            # مرحله 1: بررسی دسترسی نوتیفیکیشن\n            notification_permission_page = NotificationPermissionPage(driver)\n            notification_permission_page.allow_notification_permission()\n            logger.info(\"دسترسی نوتیفیکیشن تأیید شد.\")\n    \n            # مرحله 2: کلیک روی دکمه 'ایجاد حساب کاربری'\n            with allure.step(\"کلیک روی دکمه 'ایجاد حساب کاربری'\"):\n                logger.info(\"در حال کلیک روی دکمه 'ایجاد حساب کاربری'...\")\n                create_account_button = WebDriverWait(driver, 10).until(\n                    EC.presence_of_element_located((AppiumBy.ID, \"com.samanpr.blu.dev:id/openButton\"))\n                )\n                create_account_button.click()\n                logger.info(\"دکمه 'ایجاد حساب کاربری' با موفقیت کلیک شد.\")\n    \n            # مرحله 3: کلیک روی دکمه 'بازکردن حساب'\n            with allure.step(\"کلیک روی دکمه 'باز کردن حساب'\"):\n                logger.info(\"در حال کلیک روی دکمه 'بازکردن حساب'...\")\n                open_account_page = OpenAccountPage(driver)\n                open_account_page.click_open_account()\n                logger.info(\"دکمه 'بازکردن حساب' با موفقیت کلیک شد.\")\n    \n            # مرحله 4: انتخاب سرور UAT\n            with allure.step(\"انتخاب سرور 'UAT'\"):\n                logger.info(\"در حال انتخاب سرور 'UAT'...\")\n                select_server_page = SelectServerPage(driver)\n                select_server_page.select_uat_server()\n                logger.info(\"سرور 'UAT' با موفقیت انتخاب شد.\")\n    \n            # مرحله 5: کلیک روی دکمه 'شروع'\n            with allure.step(\"کلیک روی دکمه 'شروع'\"):\n                logger.info(\"در حال کلیک روی دکمه 'شروع'...\")\n                create_account_info_page = CreateAccountInfoPage(driver)\n                create_account_info_page.click_start()\n                logger.info(\"دکمه 'شروع' با موفقیت کلیک شد.\")\n    \n            # مرحله 6: بررسی وضعیت اولیه سوییچ و تغییر آن\n            with allure.step(\"بررسی وضعیت سوییچ موافقت با قوانین و تغییر آن\"):\n                initial_status = accept_page.is_switch_on()\n                logger.info(f\"وضعیت سوییچ: {'روشن' if initial_status else 'خاموش'}\")\n                accept_page.toggle_switch()\n                new_status = accept_page.is_switch_on()\n                logger.info(f\"وضعیت جدید سوییچ: {'روشن' if new_status else 'خاموش'}\")\n    \n            # مرحله 7: کلیک روی دکمه 'تایید'\n            with allure.step(\"کلیک روی دکمه 'تایید'\"):\n                logger.info(\"در حال کلیک روی دکمه 'تایید' بعد از تغییر وضعیت سوییچ...\")\n                accept_page.click_confirm_button()\n                logger.info(\"دکمه 'تایید' با موفقیت کلیک شد.\")\n    \n            # مرحله 8: ورود شماره تلفن\n            with allure.step(\"ورود شماره تلفن\"):\n                phone_number = mobile_number_generator()\n                phone_page = EnterPhoneNumberPage(driver)\n                phone_page.enter_phone_number(phone_number)\n                logger.info(f\"شماره تلفن {phone_number} وارد شد.\")\n    \n            # مرحله 9: کلیک روی دکمه 'بعدی'\n            with allure.step(\"کلیک روی دکمه 'بعدی'\"):\n                phone_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' با موفقیت کلیک شد.\")\n    \n            # مرحله 10: بررسی متن ریفرال\n            with allure.step(\"بررسی متن 'مانند:‌ MDMGKP'\"):\n                logger.info(\"بررسی متن ریفرال...\")\n                expected_text = text_reference[\"kyc_pages\"][\"referralInputEditText\"]\n                referral_page = ReferralPage(driver)\n                actual_text = referral_page.get_referral_field_text()\n                assert actual_text == expected_text, f\"Expected '{expected_text}', but got '{actual_text}'\"\n                logger.info(f\"متن ریفرال صحیح است: {actual_text}\")\n    \n            with allure.step(\"کلیک روی دکمه 'بعدی'\"):\n                referral_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            # مرحله 11: بررسی و وارد کردن کد ملی\n            with allure.step(\"بررسی و وارد کردن کد ملی\"):\n                logger.info(\"بررسی و ورود کد ملی...\")\n                expected_text = text_reference[\"kyc_pages\"][\"national_code\"]\n                national_page = NationalCodePage(driver)\n                actual_text = national_page.get_national_code_text()\n                assert actual_text == expected_text, f\"Expected '{expected_text}', but got '{actual_text}'\"\n                logger.info(f\"متن کد ملی صحیح است: {actual_text}\")\n                national_code = national_code_generator()\n                national_page.enter_national_code(national_code)\n                logger.info(f\"کد ملی {national_code} وارد شد.\")\n    \n            with allure.step(\"کلیک روی دکمه 'بعدی'\"):\n                national_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            # مرحله 12: اسکرول کردن سال تولد\n            with allure.step(\"اسکرول سال تولد\"):\n                birth_date_page = BirthDatePage(driver)\n                birth_date_page.scroll_year()  # اسکرول کردن سال\n                logger.info(\"سال تولد با موفقیت اسکرول شد.\")\n    \n            with allure.step(\"کلیک روی دکمه 'بعدی'\"):\n                birth_date_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            # مرحله 13: وارد کردن نام کاربری\n            with allure.step(\"وارد کردن نام کاربری\"):\n                logger.info(\"در حال وارد کردن نام کاربری جدید...\")\n                username = username_generator()\n                username_page = UserNamePage(driver)\n                username_page.enter_username(username)\n                logger.info(f\"نام کاربری {username} وارد شد.\")\n    \n            with allure.step(\"کلیک روی دکمه 'بعدی'\"):\n                username_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            # مرحله 14: وارد کردن رمز عبور\n            with allure.step(\"وارد کردن رمز عبور\"):\n                logger.info(\"در حال وارد کردن رمز عبور...\")\n                password_page = PasswordPage(driver)\n                password_page.enter_password(\"Aa123456\")\n                logger.info(\"رمز عبور وارد شد.\")\n    \n            with allure.step(\"کلیک روی دکمه 'بعدی'\"):\n                password_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            # مرحله 15: انتخاب کارت ملی\n            with allure.step(\"انتخاب گزینه کارت ملی\"):\n                logger.info(\"در حال انتخاب گزینه 'کارت ملی'...\")\n                select_national_card = SelectNationalCardOrTrackerIdPage(driver)\n                select_national_card.click_select_national_card()\n                logger.info(\"گزینه 'کارت ملی' انتخاب شد.\")\n    \n            # مرحله 16: گرفتن عکس جلو و پشت کارت ملی\n            try:\n                camera_permission_page = NotificationPermissionPage(driver)\n                camera_permission_page.allow_camera_permission()\n                logger.info(\"دسترسی به دوربین تأیید شد.\")\n            except TimeoutException:\n                logger.info(\"مجوز دوربین نمایش داده نشد، ادامه می‌دهیم.\")\n    \n            with allure.step(\"گرفتن عکس جلوی کارت ملی\"):\n                logger.info(\"در حال گرفتن عکس جلوی کارت ملی...\")\n                take_photo_page = TakePhotoPage(driver)\n                take_photo_page.click_take_photo()\n                logger.info(\"عکس جلوی کارت ملی گرفته شد.\")\n    \n            with allure.step(\"کلیک روی دکمه 'تایید'\"):\n                confirm_photo_page = ConfirmPhotoPage(driver)\n                confirm_photo_page.click_confirm_photo()\n                logger.info(\"دکمه تایید کلیک شد.\")\n    \n            with allure.step(\"گرفتن عکس پشت کارت ملی\"):\n                logger.info(\"در حال گرفتن عکس پشت کارت ملی...\")\n                take_photo_page.click_take_photo()\n                logger.info(\"عکس پشت کارت ملی گرفته شد.\")\n    \n            with allure.step(\"کلیک روی دکمه 'تایید'\"):\n                confirm_photo_page.click_confirm_photo()\n                logger.info(\"دکمه تایید کلیک شد.\")\n    \n            # مرحله 17: انتخاب شغل\n            with allure.step(\"انتخاب شغل کاربر\"):\n                logger.info(\"در حال انتخاب اولین شغل از لیست...\")\n                select_job_page = SelectJobPage(driver)\n                select_job_page.select_job()\n                select_job_page.click_confirm_job()\n                logger.info(\"شغل با موفقیت انتخاب شد.\")\n    \n            # مرحله 18: نمایش و رد ویدیو آموزشی\n            with allure.step(\"نمایش ویدیو آموزشی\"):\n                logger.info(\"ویدیو آموزشی در حال پخش است...\")\n                video_demo_page = VideoDemoPage(driver)\n                video_demo_page.click_confirm_video_demo()\n                logger.info(\"ویدیو آموزشی رد شد.\")\n    \n            # مرحله 19: ضبط ویدیو\n            with allure.step(\"ضبط ویدیو\"):\n                logger.info(\"در حال ضبط ویدیو...\")\n                video_record_page = VideoRecordingPage(driver)\n                video_record_page.click_video_recording()\n                sleep(10)\n                video_record_page.click_stop_recording_button()\n                logger.info(\"ضبط ویدیو متوقف شد.\")\n                video_record_page.click_upload_video()\n                logger.info(\"ویدیو در حال آپلود است.\")\n    \n            with allure.step(\"تایید آپلود ویدیو\"):\n                confirm_video_modal = ConfirmVideoModal(driver)\n                confirm_video_modal.click_confirm_video()\n                logger.info(\"آپلود ویدیو تایید شد.\")\n    \n            # مرحله 20: تایید نهایی و پایان\n            with allure.step(\"تایید نهایی\"):\n                final_page = FinalPage(driver)\n                final_page.click_final_confirm()\n                logger.info(\"مراحل ایجاد حساب کاربری با موفقیت به پایان رسید.\")\n    \n        except Exception as e:\n            logger.error(f\"خطا رخ داد: {e}\")\n            capture_screenshot(driver, \"account_creation_error\")\n>           raise e\n\ntests\\kyc\\test_create_account.py:244: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ntests\\kyc\\test_create_account.py:64: in test_kyc\n    open_account_page.click_open_account()\npages\\kyc\\kyc_pages.py:56: in click_open_account\n    open_account_button = WebDriverWait(self.driver, 10).until(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <selenium.webdriver.support.wait.WebDriverWait (session=\"a5d6f685-c244-4549-8038-272446425973\")>\nmethod = <function presence_of_element_located.<locals>._predicate at 0x000002090DD18040>\nmessage = ''\n\n    def until(self, method: Callable[[D], Union[Literal[False], T]], message: str = \"\") -> T:\n        \"\"\"Calls the method provided with the driver as an argument until the \\\n        return value does not evaluate to ``False``.\n    \n        :param method: callable(WebDriver)\n        :param message: optional message for :exc:`TimeoutException`\n        :returns: the result of the last call to `method`\n        :raises: :exc:`selenium.common.exceptions.TimeoutException` if timeout occurs\n        \"\"\"\n        screen = None\n        stacktrace = None\n    \n        end_time = time.monotonic() + self._timeout\n        while True:\n            try:\n                value = method(self._driver)\n                if value:\n                    return value\n            except self._ignored_exceptions as exc:\n                screen = getattr(exc, \"screen\", None)\n                stacktrace = getattr(exc, \"stacktrace\", None)\n            time.sleep(self._poll)\n            if time.monotonic() > end_time:\n                break\n>       raise TimeoutException(message, screen, stacktrace)\nE       selenium.common.exceptions.TimeoutException: Message: \nE       Stacktrace:\nE       NoSuchElementError: An element could not be located on the page using the given search parameters.\nE           at AndroidUiautomator2Driver.findElOrEls (C:\\Users\\a.jamshidi\\.appium\\node_modules\\appium-uiautomator2-driver\\node_modules\\appium-android-driver\\lib\\commands\\find.ts:86:11)\nE           at processTicksAndRejections (node:internal/process/task_queues:95:5)\nE           at AndroidUiautomator2Driver.findElOrElsWithProcessing (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:60:12)\nE           at AndroidUiautomator2Driver.findElement (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:75:12)\n\nC:\\Users\\a.jamshidi\\android_automation\\android_automation\\.venv\\lib\\site-packages\\selenium\\webdriver\\support\\wait.py:105: TimeoutException"}, "steps": [{"name": "کلیک روی دکمه 'ایجاد حساب کاربری'", "status": "passed", "start": 1729671573430, "stop": 1729671574528}, {"name": "کلیک روی دکمه 'باز کردن حساب'", "status": "broken", "statusDetails": {"message": "selenium.common.exceptions.TimeoutException: Message: \nStacktrace:\nNoSuchElementError: An element could not be located on the page using the given search parameters.\n    at AndroidUiautomator2Driver.findElOrEls (C:\\Users\\a.jamshidi\\.appium\\node_modules\\appium-uiautomator2-driver\\node_modules\\appium-android-driver\\lib\\commands\\find.ts:86:11)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at AndroidUiautomator2Driver.findElOrElsWithProcessing (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:60:12)\n    at AndroidUiautomator2Driver.findElement (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:75:12)\n", "trace": "  File \"G:\\android_automation\\tests\\kyc\\test_create_account.py\", line 64, in test_kyc\n    open_account_page.click_open_account()\n  File \"G:\\android_automation\\pages\\kyc\\kyc_pages.py\", line 56, in click_open_account\n    open_account_button = WebDriverWait(self.driver, 10).until(\n  File \"C:\\Users\\a.jamshidi\\android_automation\\android_automation\\.venv\\lib\\site-packages\\selenium\\webdriver\\support\\wait.py\", line 105, in until\n    raise TimeoutException(message, screen, stacktrace)\n"}, "start": 1729671574528, "stop": 1729671584964}], "attachments": [{"name": "account_creation_error_20241023_114944.png", "source": "4d92b8be-19e9-40c7-9987-e3652380e747-attachment.png", "type": "image/png"}, {"name": "log", "source": "110b175c-a74f-4e5b-ab4d-954beb28dc81-attachment.txt", "type": "text/plain"}, {"name": "stderr", "source": "c89398f7-091d-42f3-807a-756f4643c2a4-attachment.txt", "type": "text/plain"}], "start": 1729671568307, "stop": 1729671585521, "uuid": "4610f0f0-f09b-4760-8969-8c29ad858e99", "historyId": "190b09abcd6c5ed17aef79066d090e97", "testCaseId": "190b09abcd6c5ed17aef79066d090e97", "fullName": "tests.kyc.test_create_account#test_kyc", "labels": [{"name": "severity", "value": "critical"}, {"name": "story", "value": "Create a new user account"}, {"name": "feature", "value": "User Account Creation"}, {"name": "tag", "value": "order(1)"}, {"name": "parentSuite", "value": "tests.kyc"}, {"name": "suite", "value": "test_create_account"}, {"name": "host", "value": "ajamshidi-lap-qa"}, {"name": "thread", "value": "74996-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.kyc.test_create_account"}]}