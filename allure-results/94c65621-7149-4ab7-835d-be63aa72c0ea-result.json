{"name": "test_kyc", "status": "broken", "statusDetails": {"message": "AttributeError: 'EnterPhoneNumberPage' object has no attribute 'get_national_code_text'", "trace": "open_app_without_login = <appium.webdriver.webdriver.WebDriver (session=\"120f2bd6-207b-44a2-9819-dab32b31b73c\")>\n\n    @pytest.mark.order(1)\n    @allure.feature(\"User Account Creation\")\n    @allure.story(\"Create a new user account\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    def test_kyc(open_app_without_login):\n        driver = open_app_without_login\n        accept_page = AcceptRulesAndRegulations(driver)\n        # بارگذاری فایل JSON برای دریافت متون مرجع\n        text_reference = load_text_reference()\n    \n        # متغیر برای ذخیره نتیجه تست\n        errors = []\n        try:\n            # بررسی دسترسی نوتیفیکیشن\n            notification_permission_page = NotificationPermissionPage(driver)\n            notification_permission_page.allow_notification_permission()\n            logger.info(\"Clicked on 'Allow' button for notification permission.\")\n    \n            # مرحله 1: کلیک روی دکمه 'ایجاد حساب کاربری'\n            try:\n                with allure.step(\"Click on 'Create Account' button\"):\n                    logger.info(\"کلیک روی دکمه 'ایجاد حساب کاربری'...\")\n                    create_account_button = WebDriverWait(driver, 10).until(\n                        EC.presence_of_element_located((AppiumBy.ID, \"com.samanpr.blu.dev:id/openButton\"))\n                    )\n                    create_account_button.click()\n                    logger.info(\"دکمه 'ایجاد حساب کاربری' کلیک شد.\")\n            except TimeoutException:\n                logger.info(\"No login page displayed, continuing.\")\n    \n            # مرحله 2: کلیک روی دکمه 'بازکردن حساب'\n            with allure.step(\"Click on 'Open Account' button\"):\n                logger.info(\"کلیک روی دکمه 'بازکردن حساب'...\")\n                open_account_page = OpenAccountPage(driver)\n                open_account_page.click_open_account()\n                logger.info(\"دکمه 'بازکردن حساب' کلیک شد.\")\n    \n            # مرحله 3: انتخاب UAT در سرور\n            with allure.step(\"click on 'UAT' from server selection\"):\n                logger.info(\"انتخاب سرور 'UAT'...\")\n                select_server_page = SelectServerPage(driver)\n                select_server_page.select_uat_server()\n                logger.info(\"سرور 'UAT' انتخاب شد.\")\n    \n            # مرحله 4: کلیک روی 'شروع'\n            with allure.step(\"Click on 'Start' button\"):\n                logger.info(\"کلیک روی دکمه 'شروع'...\")\n                create_account_info_page = CreateAccountInfoPage(driver)\n                create_account_info_page.click_start()\n                logger.info(\"دکمه 'شروع' کلیک شد.\")\n    \n            # بررسی وضعیت اولیه سوییچ\n            with allure.step(\"Check initial state of the switch\"):\n                initial_status = accept_page.is_switch_on()\n                logger.info(f\"Initial switch status: {'ON' if initial_status else 'OFF'}\")\n                allure.attach(f\"Initial switch status: {'ON' if initial_status else 'OFF'}\", \"Switch Status\",\n                              allure.attachment_type.TEXT)\n    \n            # تغییر وضعیت سوییچ\n            with allure.step(\"Toggle the agreement switch\"):\n                logger.info(\"کلیک بر روی تاگل سوییچ موافقت با قوانین و مقررات ...\")\n                accept_page.toggle_switch()  # استفاده از متد toggle_switch\n                new_status = accept_page.is_switch_on()\n                logger.info(f\"Switch status after toggle: {'ON' if new_status else 'OFF'}\")\n                allure.attach(f\"New switch status: {'ON' if new_status else 'OFF'}\", \"Switch Status After Toggle\",\n                              allure.attachment_type.TEXT)\n    \n            # کلیک روی دکمه تایید بعد از تغییر وضعیت\n            with allure.step(\"Click confirm button after toggle\"):\n                logger.info(\"کلیک روی دکمه تایید...\")\n                accept_page.click_confirm_button()\n                logger.info(\"دکمه تایید کلیک شد و به صفحه وارد کردن شماره تلفن هدایت شد.\")\n            # مرحله 2: وارد کردن شماره تلفن\n            with allure.step(\"Enter phone number\"):\n                logger.info(\"ورود شماره تلفن ...\")\n                # فراخوانی تابع mobile_number_generator برای تولید شماره موبایل\n                phone_number = mobile_number_generator()\n                phone_page = EnterPhoneNumberPage(driver)\n                phone_page.enter_phone_number(phone_number)\n    \n            logger.info(f\"شماره تلفن وارد شد: {phone_number}\")\n    \n            # مرحله 3: کلیک روی دکمه \"بعدی\"\n            with allure.step(\"Click next button\"):\n                logger.info(\"کلیک روی دکمه 'بعدی'...\")\n                phone_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            with (allure.step(\"Click next button\")):\n                logger.info(\"کلیک روی دکمه 'بعدی'...\")\n                referral_page = ReferralPage(driver)\n                referral_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            # بررسی متن کد ملی\n            with allure.step(\"Check 'کد ملی ۱۰ رقمی' text\"):\n                logger.info(\"بررسی متن کد ملی...\")\n                expected_text = text_reference[\"kyc_pages\"][\"national_code\"]\n    \n                # استفاده از شیء درست برای فراخوانی متد\n                phone_page = EnterPhoneNumberPage(driver)\n                actual_text = phone_page.get_national_code_text()  # به درستی شیء phone_page استفاده می‌شود\n    \n                assert actual_text == expected_text, \\\n                    f\"Expected '{expected_text}', but got '{actual_text}'\"\n                logger.info(f\"متن کد ملی صحیح است: {actual_text}\")\n    \n            with allure.step(\"Enter national code\"):\n                logger.info(\"ورود کد ملی ...\")\n                # گرفتن اسکرین‌شات قبل از ورود کد ملی برای بررسی وضعیت صفحه\n                capture_screenshot(driver, \"before_entering_national_code\")\n                try:\n                    # فراخوانی تابع national_code_generator برای تولید کد ملی\n                    national_code = national_code_generator()\n                    national_code_page = EnterPhoneNumberPage(driver)\n    \n                    # افزایش زمان انتظار به 20 ثانیه\n                    national_code_page.enter_phone_number(national_code)\n                    logger.info(f\"کدملی وارد شد: {national_code}\")\n    \n                except TimeoutException as e:\n                    logger.error(f\"خطا در پیدا کردن فیلد کد ملی: {e}\")\n                    capture_screenshot(driver, \"national_code_error\")\n                    raise e\n    \n            # مرحله 3: کلیک روی دکمه \"بعدی\"\n            with allure.step(\"Click next button\"):\n                logger.info(\"کلیک روی دکمه 'بعدی'...\")\n                phone_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n        except Exception as e:\n            logger.error(f\"خطا رخ داد: {e}\")\n            capture_screenshot(driver, \"account_creation_error\")\n>           raise e\n\ntests\\kyc\\test_create_account.py:159: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nopen_app_without_login = <appium.webdriver.webdriver.WebDriver (session=\"120f2bd6-207b-44a2-9819-dab32b31b73c\")>\n\n    @pytest.mark.order(1)\n    @allure.feature(\"User Account Creation\")\n    @allure.story(\"Create a new user account\")\n    @allure.severity(allure.severity_level.CRITICAL)\n    def test_kyc(open_app_without_login):\n        driver = open_app_without_login\n        accept_page = AcceptRulesAndRegulations(driver)\n        # بارگذاری فایل JSON برای دریافت متون مرجع\n        text_reference = load_text_reference()\n    \n        # متغیر برای ذخیره نتیجه تست\n        errors = []\n        try:\n            # بررسی دسترسی نوتیفیکیشن\n            notification_permission_page = NotificationPermissionPage(driver)\n            notification_permission_page.allow_notification_permission()\n            logger.info(\"Clicked on 'Allow' button for notification permission.\")\n    \n            # مرحله 1: کلیک روی دکمه 'ایجاد حساب کاربری'\n            try:\n                with allure.step(\"Click on 'Create Account' button\"):\n                    logger.info(\"کلیک روی دکمه 'ایجاد حساب کاربری'...\")\n                    create_account_button = WebDriverWait(driver, 10).until(\n                        EC.presence_of_element_located((AppiumBy.ID, \"com.samanpr.blu.dev:id/openButton\"))\n                    )\n                    create_account_button.click()\n                    logger.info(\"دکمه 'ایجاد حساب کاربری' کلیک شد.\")\n            except TimeoutException:\n                logger.info(\"No login page displayed, continuing.\")\n    \n            # مرحله 2: کلیک روی دکمه 'بازکردن حساب'\n            with allure.step(\"Click on 'Open Account' button\"):\n                logger.info(\"کلیک روی دکمه 'بازکردن حساب'...\")\n                open_account_page = OpenAccountPage(driver)\n                open_account_page.click_open_account()\n                logger.info(\"دکمه 'بازکردن حساب' کلیک شد.\")\n    \n            # مرحله 3: انتخاب UAT در سرور\n            with allure.step(\"click on 'UAT' from server selection\"):\n                logger.info(\"انتخاب سرور 'UAT'...\")\n                select_server_page = SelectServerPage(driver)\n                select_server_page.select_uat_server()\n                logger.info(\"سرور 'UAT' انتخاب شد.\")\n    \n            # مرحله 4: کلیک روی 'شروع'\n            with allure.step(\"Click on 'Start' button\"):\n                logger.info(\"کلیک روی دکمه 'شروع'...\")\n                create_account_info_page = CreateAccountInfoPage(driver)\n                create_account_info_page.click_start()\n                logger.info(\"دکمه 'شروع' کلیک شد.\")\n    \n            # بررسی وضعیت اولیه سوییچ\n            with allure.step(\"Check initial state of the switch\"):\n                initial_status = accept_page.is_switch_on()\n                logger.info(f\"Initial switch status: {'ON' if initial_status else 'OFF'}\")\n                allure.attach(f\"Initial switch status: {'ON' if initial_status else 'OFF'}\", \"Switch Status\",\n                              allure.attachment_type.TEXT)\n    \n            # تغییر وضعیت سوییچ\n            with allure.step(\"Toggle the agreement switch\"):\n                logger.info(\"کلیک بر روی تاگل سوییچ موافقت با قوانین و مقررات ...\")\n                accept_page.toggle_switch()  # استفاده از متد toggle_switch\n                new_status = accept_page.is_switch_on()\n                logger.info(f\"Switch status after toggle: {'ON' if new_status else 'OFF'}\")\n                allure.attach(f\"New switch status: {'ON' if new_status else 'OFF'}\", \"Switch Status After Toggle\",\n                              allure.attachment_type.TEXT)\n    \n            # کلیک روی دکمه تایید بعد از تغییر وضعیت\n            with allure.step(\"Click confirm button after toggle\"):\n                logger.info(\"کلیک روی دکمه تایید...\")\n                accept_page.click_confirm_button()\n                logger.info(\"دکمه تایید کلیک شد و به صفحه وارد کردن شماره تلفن هدایت شد.\")\n            # مرحله 2: وارد کردن شماره تلفن\n            with allure.step(\"Enter phone number\"):\n                logger.info(\"ورود شماره تلفن ...\")\n                # فراخوانی تابع mobile_number_generator برای تولید شماره موبایل\n                phone_number = mobile_number_generator()\n                phone_page = EnterPhoneNumberPage(driver)\n                phone_page.enter_phone_number(phone_number)\n    \n            logger.info(f\"شماره تلفن وارد شد: {phone_number}\")\n    \n            # مرحله 3: کلیک روی دکمه \"بعدی\"\n            with allure.step(\"Click next button\"):\n                logger.info(\"کلیک روی دکمه 'بعدی'...\")\n                phone_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            with (allure.step(\"Click next button\")):\n                logger.info(\"کلیک روی دکمه 'بعدی'...\")\n                referral_page = ReferralPage(driver)\n                referral_page.click_next_button()\n                logger.info(\"دکمه 'بعدی' کلیک شد.\")\n    \n            # بررسی متن کد ملی\n            with allure.step(\"Check 'کد ملی ۱۰ رقمی' text\"):\n                logger.info(\"بررسی متن کد ملی...\")\n                expected_text = text_reference[\"kyc_pages\"][\"national_code\"]\n    \n                # استفاده از شیء درست برای فراخوانی متد\n                phone_page = EnterPhoneNumberPage(driver)\n>               actual_text = phone_page.get_national_code_text()  # به درستی شیء phone_page استفاده می‌شود\nE               AttributeError: 'EnterPhoneNumberPage' object has no attribute 'get_national_code_text'\n\ntests\\kyc\\test_create_account.py:127: AttributeError"}, "steps": [{"name": "Click on 'Create Account' button", "status": "broken", "statusDetails": {"message": "selenium.common.exceptions.TimeoutException: Message: \nStacktrace:\nNoSuchElementError: An element could not be located on the page using the given search parameters.\n    at AndroidUiautomator2Driver.findElOrEls (C:\\Users\\a.jamshidi\\.appium\\node_modules\\appium-uiautomator2-driver\\node_modules\\appium-android-driver\\lib\\commands\\find.ts:86:11)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at AndroidUiautomator2Driver.findElOrElsWithProcessing (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:60:12)\n    at AndroidUiautomator2Driver.findElement (C:\\Users\\a.jamshidi\\AppData\\Roaming\\npm\\node_modules\\appium\\node_modules\\@appium\\base-driver\\lib\\basedriver\\commands\\find.ts:75:12)\n", "trace": "  File \"G:\\android_automation\\tests\\kyc\\test_create_account.py\", line 48, in test_kyc\n    create_account_button = WebDriverWait(driver, 10).until(\n  File \"C:\\Users\\a.jamshidi\\android_automation\\android_automation\\.venv\\lib\\site-packages\\selenium\\webdriver\\support\\wait.py\", line 105, in until\n    raise TimeoutException(message, screen, stacktrace)\n"}, "start": 1729428978312, "stop": 1729428988766}, {"name": "Click on 'Open Account' button", "status": "passed", "start": 1729428988768, "stop": 1729428990209}, {"name": "click on 'UAT' from server selection", "status": "passed", "start": 1729428990209, "stop": 1729428991361}, {"name": "Click on 'Start' button", "status": "passed", "start": 1729428991361, "stop": 1729428992148}, {"name": "Check initial state of the switch", "status": "passed", "attachments": [{"name": "Switch Status", "source": "e81f78ec-42f9-4480-b668-55aaa1c05644-attachment.txt", "type": "text/plain"}], "start": 1729428992148, "stop": 1729428992290}, {"name": "Toggle the agreement switch", "status": "passed", "attachments": [{"name": "Switch Status After Toggle", "source": "55a70d94-19b7-4d3f-9aa7-230edf3988a4-attachment.txt", "type": "text/plain"}], "start": 1729428992290, "stop": 1729428993464}, {"name": "Click confirm button after toggle", "status": "passed", "start": 1729428993464, "stop": 1729428994701}, {"name": "Enter phone number", "status": "passed", "start": 1729428994701, "stop": 1729428995508}, {"name": "Click next button", "status": "passed", "start": 1729428995509, "stop": 1729428998310}, {"name": "Click next button", "status": "passed", "start": 1729428998310, "stop": 1729428999559}, {"name": "Check 'کد ملی ۱۰ رقمی' text", "status": "broken", "statusDetails": {"message": "AttributeError: 'EnterPhoneNumberPage' object has no attribute 'get_national_code_text'\n", "trace": "  File \"G:\\android_automation\\tests\\kyc\\test_create_account.py\", line 127, in test_kyc\n    actual_text = phone_page.get_national_code_text()  # به درستی شیء phone_page استفاده می‌شود\n"}, "start": 1729428999559, "stop": 1729428999559}], "attachments": [{"name": "account_creation_error_20241020_162639.png", "source": "3aa467e7-f443-45f1-a404-c12ce69fbd6d-attachment.png", "type": "image/png"}, {"name": "log", "source": "62ce4bbb-67bb-4da4-adc0-6ebc495c8273-attachment.txt", "type": "text/plain"}, {"name": "stderr", "source": "a6a4d71b-e21a-452a-b100-86dd45ce60dc-attachment.txt", "type": "text/plain"}], "start": 1729428977490, "stop": 1729428999972, "uuid": "db9376ae-57f7-4219-a02b-408bcc4a6897", "historyId": "190b09abcd6c5ed17aef79066d090e97", "testCaseId": "190b09abcd6c5ed17aef79066d090e97", "fullName": "tests.kyc.test_create_account#test_kyc", "labels": [{"name": "feature", "value": "User Account Creation"}, {"name": "story", "value": "Create a new user account"}, {"name": "severity", "value": "critical"}, {"name": "tag", "value": "order(1)"}, {"name": "parentSuite", "value": "tests.kyc"}, {"name": "suite", "value": "test_create_account"}, {"name": "host", "value": "ajamshidi-lap-qa"}, {"name": "thread", "value": "42144-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.kyc.test_create_account"}]}